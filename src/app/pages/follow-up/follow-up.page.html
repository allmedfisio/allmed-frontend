<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="goBack()">
        <ion-img
          src="assets/logo-clinica.png"
          style="width: 70px; height: 70px"
        ></ion-img>
      </ion-button>
    </ion-buttons>
    <ion-title>Follow-up</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding follow-up-content">
  <ng-container *ngIf="followUpPatients$ | async as patients; else loading">
    <div *ngIf="patients.length; else empty" class="patients-grid">
      <ion-card class="card-soft" *ngFor="let p of patients">
        <ion-card-content>
          <ion-grid fixed>
            <ion-row>
              <ion-col size="9">
                <h2 class="name">{{ p.full_name }}</h2>
                <h2 class="study">
                  Medico: {{ p.assigned_doctor_name || 'N/A' }}
                </h2>
                <h2 class="app">
                  Ultima visita: {{ p.last_visit_date | date: 'dd/MM/yyyy' }}
                </h2>
                <h2 class="app" *ngIf="p.phone">Tel: {{ p.phone }}</h2>
              </ion-col>
              <ion-col
                size="3"
                style="
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <ion-button
                  size="small"
                  color="primary"
                  (click)="completeFollowUp(p)"
                >
                  <ion-icon name="checkmark-done-outline"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-card-content>
      </ion-card>
    </div>
  </ng-container>

  <ng-template #empty>
    <div class="empty-state">
      <p>Nessun paziente da richiamare al momento</p>
    </div>
  </ng-template>

  <ng-template #loading>
    <ion-spinner
      name="crescent"
      style="display: block; margin: 2rem auto"
    ></ion-spinner>
  </ng-template>
</ion-content>
